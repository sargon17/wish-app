{"id":"3lqbtzet","parent_id":null,"name":"Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams)","description":"# Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams)\n\n## Summary\nThis plan prioritizes features that reduce structural risk first, then unlock monetization with confidence.  \nGuiding choices locked from your input:\n- ICP: small SaaS teams\n- Optimization: technical foundation\n- Cadence: no fixed timeline, ship in fast iterations with strict dependency order\n\n## Prioritized Feature Roadmap (Execution Order)\n\n## Iteration 1: Access Control and Data Isolation (P0)\n1. Implement workspace model.\n2. Add membership model with roles (`owner`, `admin`, `member`, `viewer`).\n3. Move project ownership from single user to workspace scope.\n4. Enforce workspace-scoped authorization in all Convex queries/mutations.\n5. Enforce the same checks in all public HTTP routes.\n\nExit criteria:\n- No cross-workspace data access possible.\n- Every project/request/status/comment/upvote operation is role-gated.\n\n## Iteration 2: Public Feedback Surface (P0)\n1. Add public project endpoint with stable slug (`/p/:projectSlug`).\n2. Add public request submission UI and endpoint.\n3. Add anonymous identity strategy for external users (`clientId` cookie/device key).\n4. Add public upvote/comment controls with abuse guards.\n5. Add moderation controls (archive/hide/delete external content).\n\nExit criteria:\n- External users can submit, vote, and comment without internal auth.\n- Internal team can moderate safely.\n\n## Iteration 3: Anti-Abuse and Operational Safety (P0)\n1. Add rate limiting to all public write endpoints.\n2. Add spam controls (captcha/turnstile + payload guards).\n3. Add action audit logs (status change, delete, role change, moderation actions).\n4. Add error monitoring and alerting baseline.\n5. Add backup/restore runbook.\n\nExit criteria:\n- Public endpoints resist bot abuse.\n- Critical incidents are observable and diagnosable.\n\n## Iteration 4: Team Collaboration UX (P1)\n1. Add invite flow (email-based invite links).\n2. Add member management screen (role changes/removal).\n3. Add project-level access toggles within workspace.\n4. Add “activity feed” per project (request and status events).\n\nExit criteria:\n- Small team collaboration is complete end-to-end.\n- Owners/admins can manage access without manual DB work.\n\n## Iteration 5: Monetization Infrastructure (P1)\n1. Integrate Stripe checkout and subscription state sync via webhooks.\n2. Add plan model and entitlements.\n3. Enforce limits in backend (`projects`, `members`, `requests/month`, `API usage`).\n4. Add billing settings page (plan, renewal, upgrade/downgrade, portal link).\n\nExit criteria:\n- Subscription lifecycle is production-safe.\n- Limits are enforced server-side and reflected in UI.\n\n## Iteration 6: Activation and Retention Layer (P2)\n1. Add onboarding checklist (create workspace -> project -> first public request).\n2. Add email notifications (new request, comment, status update).\n3. Add weekly digest.\n4. Add CSV export for requests/comments.\n\nExit criteria:\n- New accounts reach first value quickly.\n- Teams have enough communication loop to retain.\n\n## Public API / Interface / Type Changes to Introduce\n\n1. Data model additions:\n- `workspaces`\n- `workspaceMemberships`\n- `projectVisibility` (`private` | `public`)\n- `projectSlug` (unique)\n- `invites`\n- `subscriptions`\n- `entitlements`\n- `auditLogs`\n\n2. Existing model changes:\n- `projects.user` -> `projects.workspaceId`\n- Requests/comments/upvotes: enforce workspace and role context checks\n\n3. Public HTTP API additions:\n- `GET /api/public/project/:slug`\n- `POST /api/public/project/:slug/request`\n- `POST /api/public/project/:slug/request/:id/comment`\n- `POST /api/public/project/:slug/request/:id/upvote`\n\n4. Authz interfaces:\n- Shared permission guard helpers for Convex handlers and Hono routes\n- Role capability map (single source of truth)\n\n## Testing and Validation Plan\n\n1. Authorization tests:\n- Member cannot access another workspace data.\n- Viewer cannot mutate.\n- Admin/member permissions behave as defined.\n- Public routes cannot mutate private projects.\n\n2. Public abuse tests:\n- Rate limit reached returns expected failure.\n- Invalid payload/captcha failures are rejected.\n- Duplicate/bot-like bursts are throttled.\n\n3. Billing tests:\n- New subscription activates entitlements.\n- Cancellation and failed payments downgrade correctly.\n- Limits block writes when exceeded.\n\n4. End-to-end scenarios:\n- Team setup: owner creates workspace, invites member, member triages requests.\n- External flow: anonymous user submits request, upvotes, comments.\n- Internal flow: status changes, notifications emitted, activity logged.\n\n5. Regression gates per iteration:\n- `bun lint:strict`\n- `bun check-types`\n- `bun build`\n- Critical smoke e2e for dashboard + public board paths\n\n## Rollout Strategy\n\n1. Feature flags:\n- `workspaces_v1`\n- `public_board_v1`\n- `billing_v1`\n\n2. Progressive release:\n- Internal dogfood workspace first.\n- Selected beta workspaces second.\n- Default-on after metrics stability.\n\n3. Observability metrics:\n- Unauthorized access attempts\n- Public write success/failure ratio\n- Spam rejection rate\n- Invite acceptance rate\n- Activation funnel: signup -> first project -> first public request\n\n## Assumptions and Defaults\n1. No fixed timeline; work ships in rapid iterations with strict dependency order.\n2. Small SaaS teams are the primary buyer.\n3. Technical foundation is prioritized over immediate feature breadth.\n4. Billing is intentionally sequenced after security/workspace/public-surface hardening.\n5. Existing UI stack stays Next.js + Convex + Clerk + shadcn/Radix + Tailwind.\n","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-11T15:01:26.402Z","updated_at":"2026-02-11T15:01:26.402Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":["c6p4o66e","bwpq0n0h","gv1b1m8c","ngq8301t","zyir5wrt","fdnnaf5y"]}
{"id":"bwpq0n0h","parent_id":"3lqbtzet","name":"Iteration 1: Access Control and Data Isolation","description":"Implement workspace model, role-based memberships (owner/admin/member/viewer), migrate project ownership from user to workspace, and enforce workspace-scoped authorization across Convex queries/mutations and public HTTP routes. Exit criteria: no cross-workspace access and all project/request/status/comment/upvote mutations role-gated. Part of parent task: Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams).","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-11T15:02:07.966Z","updated_at":"2026-02-11T15:02:07.966Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"c6p4o66e","parent_id":"3lqbtzet","name":"Iteration 5: Monetization Infrastructure","description":"Integrate Stripe checkout and webhook subscription sync, add plan+entitlement model, enforce server-side limits (projects, members, requests/month, API usage), and build billing settings page (plan, renewal, upgrade/downgrade, portal link). Exit criteria: subscription lifecycle production-safe and limits enforced server-side and reflected in UI. Part of parent task: Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams).","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-11T15:01:47.803Z","updated_at":"2026-02-11T15:01:47.803Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"fdnnaf5y","parent_id":"3lqbtzet","name":"Iteration 6: Activation and Retention Layer","description":"Add onboarding checklist (workspace -> project -> first public request), event notifications (new request, comment, status update), weekly digest, and CSV export for requests/comments. Exit criteria: faster first value for new accounts and retention-supporting communication loops for teams. Part of parent task: Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams).","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-11T15:02:27.635Z","updated_at":"2026-02-11T15:02:27.635Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"gv1b1m8c","parent_id":"3lqbtzet","name":"Iteration 2: Public Feedback Surface","description":"Add public project endpoint with stable slug (/p/:projectSlug), public request submission UI+endpoint, anonymous external identity strategy via clientId cookie/device key, public upvote/comment controls with abuse guards, and moderation controls (archive/hide/delete). Exit criteria: external users can submit/vote/comment without internal auth and internal team can moderate safely. Part of parent task: Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams).","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-11T15:02:13.081Z","updated_at":"2026-02-11T15:02:13.081Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"ngq8301t","parent_id":"3lqbtzet","name":"Iteration 3: Anti-Abuse and Operational Safety","description":"Add rate limiting on all public write endpoints, spam controls (captcha/turnstile and payload guards), audit logs for critical actions, error monitoring/alerting baseline, and backup+restore runbook. Exit criteria: public endpoints resist bot abuse and incidents are observable/diagnosable. Part of parent task: Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams).","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-11T15:02:17.658Z","updated_at":"2026-02-11T15:02:17.658Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"zyir5wrt","parent_id":"3lqbtzet","name":"Iteration 4: Team Collaboration UX","description":"Add invite flow with email links, member management UI for role changes/removal, project-level access toggles inside workspace, and project activity feed for request/status events. Exit criteria: small-team collaboration complete end-to-end and owners/admins can manage access without DB intervention. Part of parent task: Next Features Plan: Fast Iterations, Foundation-First (Small SaaS Teams).","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-11T15:02:22.358Z","updated_at":"2026-02-11T15:02:22.358Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
